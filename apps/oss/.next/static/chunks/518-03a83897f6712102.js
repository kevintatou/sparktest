"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[518],{7518:function(e,s,t){t.d(s,{r:function(){return x}});var n=t(9205),a=t(1470),r=t(4463),i=t(2543),l=t(4968),d=t(6379),o=t(3811),c=t(2586),m=t(8832),u=t(1026),f=t(9132),p=t(5338);function x(e){let{def:s}=e,t=(0,r.useRouter)(),{toast:x}=(0,f.pm)(),[h,g]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{s&&v({name:"".concat(s.name," Run"),image:s.image,commands:[...s.commands],useCustomSettings:!1})},[s]);let b=e=>{j&&v({...j,commands:j.commands.filter((s,t)=>t!==e)})},N=(e,s)=>{j&&v({...j,commands:j.commands.map((t,n)=>n===e?s:t)})},y=async e=>{if(e.preventDefault(),j){g(!0);try{let e=j.useCustomSettings?{name:j.name,image:j.image,commands:j.commands.filter(Boolean)}:{name:j.name},n=await p.t.createRun(s.id,e);if(!n||!n.id){console.error("createRun did not return a valid run object:",n),x({title:"Error starting test",description:"Failed to create test run: missing run ID.",variant:"destructive"}),g(!1);return}x({title:"Test started successfully",description:'Test "'.concat(n.name,'" is now running.')}),t.push("/runs/".concat(n.id))}catch(e){x({title:"Error starting test",description:e instanceof Error?e.message:"Unknown error occurred",variant:"destructive"})}finally{g(!1)}}};return j?(0,n.jsx)("form",{onSubmit:y,children:(0,n.jsxs)(o.Zb,{className:"shadow-sm",children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsxs)(o.ll,{children:["Run Test: ",s.name]}),(0,n.jsx)(o.SZ,{children:s.description})]}),(0,n.jsxs)(o.aY,{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(m._,{htmlFor:"name",children:"Run Name"}),(0,n.jsx)(c.I,{id:"name",value:j.name,onChange:e=>v({...j,name:e.target.value}),required:!0,className:"transition-all focus-visible:ring-primary"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(u.r,{id:"custom-settings",checked:j.useCustomSettings,onCheckedChange:e=>v({...j,useCustomSettings:e})}),(0,n.jsx)(m._,{htmlFor:"custom-settings",children:"Use custom settings for this run"})]}),j.useCustomSettings?(0,n.jsxs)("div",{className:"animate-in fade-in-50 space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(m._,{htmlFor:"image",children:"Container Image"}),(0,n.jsx)(c.I,{id:"image",value:j.image,onChange:e=>v({...j,image:e.target.value}),required:!0,className:"transition-all focus-visible:ring-primary"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"The Docker image that contains your test code and dependencies"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(m._,{children:"Commands"}),(0,n.jsxs)(d.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{j&&v({...j,commands:[...j.commands,""]})},children:[(0,n.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Add Command"]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[j.commands.map((e,s)=>(0,n.jsxs)("div",{className:"flex gap-2 animate-in fade-in-50",children:[(0,n.jsx)(c.I,{value:e,onChange:e=>N(s,e.target.value),required:0===s,className:"transition-all focus-visible:ring-primary"}),s>0&&(0,n.jsxs)(d.z,{type:"button",variant:"outline",size:"icon",onClick:()=>b(s),className:"hover:bg-red-500/10 hover:text-red-500 hover:border-red-500/20",children:[(0,n.jsx)(l.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Remove command"})]})]},s)),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Commands will be executed in sequence. First command is required."})]})]})]}):(0,n.jsxs)("div",{className:"space-y-4 border rounded-md p-4 bg-muted/30 animate-in fade-in-50",children:[(0,n.jsx)("h3",{className:"font-medium",children:"Default Settings"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Image:"})," ",s.image]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Commands:"}),(0,n.jsx)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:s.commands.map((e,s)=>(0,n.jsx)("li",{children:e},s))})]})]})]})]}),(0,n.jsxs)(o.eW,{className:"flex justify-between",children:[(0,n.jsx)(d.z,{variant:"outline",type:"button",onClick:()=>t.push("/runs"),children:"Cancel"}),(0,n.jsx)(d.z,{type:"submit",disabled:h,className:"shadow-sm",children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Starting..."]}):"Run Test"})]})]})}):(0,n.jsxs)("div",{className:"text-center py-10",children:[(0,n.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-primary border-r-transparent"}),(0,n.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading test run form..."})]})}},3811:function(e,s,t){t.d(s,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return c},eW:function(){return m},ll:function(){return d}});var n=t(9205),a=t(1470),r=t(7999);let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("w-full rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let m=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center gap-2 p-6 pt-0",t),...a})});m.displayName="CardFooter"},2586:function(e,s,t){t.d(s,{I:function(){return i}});var n=t(9205),a=t(1470),r=t(7999);let i=a.forwardRef((e,s)=>{let{className:t,type:a,...i}=e;return(0,n.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});i.displayName="Input"},8832:function(e,s,t){t.d(s,{_:function(){return o}});var n=t(9205),a=t(1470),r=t(2016),i=t(9549),l=t(7999);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(r.f,{ref:s,className:(0,l.cn)(d(),t),...a})});o.displayName=r.f.displayName},1026:function(e,s,t){t.d(s,{r:function(){return l}});var n=t(9205),a=t(1470),r=t(3602),i=t(7999);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,n.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=r.fC.displayName},9132:function(e,s,t){t.d(s,{pm:function(){return u}});var n=t(1470);let a=0,r=new Map,i=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},l=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},d=[],o={toasts:[]};function c(e){o=l(o,e),d.forEach(e=>{e(o)})}function m(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||n()}}}),{id:t,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=n.useState(o);return n.useEffect(()=>(d.push(s),()=>{let e=d.indexOf(s);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}}]);