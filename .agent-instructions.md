# Agent Instructions for SparkTest Development

## üö® CRITICAL: Always Test Locally First

**BEFORE ANY MAJOR PUSH OR COMMIT**: Always run GitHub Actions workflows locally using `act` to catch issues early and avoid failed CI/CD runs.

```bash
# Test the most common workflows locally:
act pull_request -W .github/workflows/rust-format.yml
act pull_request -W .github/workflows/ci.yml

# For formatting checks:
pnpm format:check  # JavaScript/TypeScript formatting
cargo fmt --check --all  # Rust formatting
```

## Standard Workflow Process

When making changes to the SparkTest monorepo, always follow this process:

### 1. Fix Code Quality Issues First

- Run `pnpm --filter "@tatou/oss" lint` to identify ESLint errors
- Fix all unused imports and variables
- Ensure TypeScript compilation passes with `pnpm build`

### 2. Mandatory Local Testing with act

**REQUIRED STEP - DO NOT SKIP**: Test GitHub Actions workflows locally before any commit to avoid CI/CD failures.

- Install `act` if not available: `curl https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash`
- **ALWAYS run these workflows locally before pushing**:

  ```bash
  # Most critical workflows to test locally:
  act pull_request -W .github/workflows/rust-format.yml  # Test Rust formatting
  act pull_request -W .github/workflows/ci.yml           # Test CI build

  # Also test formatting before pushing:
  pnpm format:check      # Prettier check
  cargo fmt --check --all # Rust formatting check
  ```

**Benefits of local testing:**

- ‚ö° Catches issues in ~2 minutes vs ~10+ minutes on GitHub Actions
- üí∞ Saves GitHub Actions usage/costs
- üöÄ Prevents failed PR builds and maintains clean git history
- üõ°Ô∏è Ensures confidence before pushing to production

### 3. Commit and Push

- Commit all fixes with descriptive messages
- Push changes to main branch
- Monitor GitHub Actions for workflow status

### 4. Release Process

- After confirming all workflows pass, create new release
- Use semantic versioning (e.g., v2.1.0)
- Ensure both Cargo and NPM publishing workflows succeed

## Design System Rules

### Style Goals

- Modern developer tool aesthetic (Linear, Vercel, Supabase style)
- Approachable, light, and fun while remaining clean and professional
- Prioritize clarity, whitespace, and interactivity

### Design Rules

#### 1. Colors (CONSISTENCY IS KEY!)

- **Primary brand color**: slate-900 (#0F172A) - use for active states, primary buttons
- **Neutral backgrounds**:
  - Light mode: white, slate-50 (#F8FAFC), slate-100 (#F1F5F9)
  - Dark mode: slate-900 (#0F172A), slate-800 (#1E293B), slate-700 (#334155)
- **Header backgrounds**:
  - Light mode: white with subtle blue tint
  - Dark mode: rich navy/slate instead of gray
- **Accent colors ONLY for statuses**:
  - Success: emerald-600 (#059669) / emerald-500 (dark mode)
  - Fail: rose-600 (#E11D48) / rose-500 (dark mode)
  - Running: amber-500 (#F59E0B) / amber-400 (dark mode)
- **Interactive elements**: ALL use slate-900 primary color (sidebar active, buttons, etc.)
- **Happiness factor**: Use warmer slates instead of cold grays, subtle blue undertones
- **RULE**: Never mix different blues/grays for interactive elements

#### 2. Typography

- Headings: medium weight (500‚Äì600), not heavy bold
- Body: gray-700, regular size
- Secondary info: gray-400, smaller and lighter
- Reduce formal wording (e.g., "Runs" vs "Test Execution Overview")

#### 3. Layout & Spacing

- Cards: rounded-xl (12‚Äì16px), shadow-sm, generous padding
- Visual separation with whitespace, not borders
- Lists highlight main info first, secondary info smaller/lighter

#### 4. Components

- Badges: pill-shaped, subtle backgrounds (bg-green-100 text-green-700)
- Buttons: minimal, primary actions in green
- Tables/lists: clean rows, no heavy dividers, whitespace separation

#### 5. Micro-interactions

- Hover states: `hover:shadow-md`, `hover:bg-gray-50`
- Smooth transitions for new/updated items
- Subtle animations that feel "alive" but not distracting

### Implementation Notes

- Use React + TailwindCSS
- Maintain current structure but apply design system
- Ensure component consistency
- Optimize for developer experience: approachable, scannable, balanced

## Critical Rules

### Color Consistency

- **NEVER** mix different shades of blue/gray for interactive elements
- ALL active states, primary buttons, and interactive elements use gray-900
- Status colors are the ONLY exception to neutral palette
- Test both light and dark modes for every change

### Dark Mode Support

- Every component must work in both light and dark modes
- Use Tailwind's `dark:` prefix for dark mode styles
- Test dark mode toggle functionality
- Maintain same contrast ratios in both modes

### Before Every Commit

1. Test light/dark mode toggle
2. Verify color consistency across all interactive elements
3. Run accessibility checks
4. Ensure responsive design works
